import{c as s}from"./cart.Dwi38V3E.js";const l=document.getElementById("cart-container"),p=document.getElementById("total-amount"),y=document.getElementById("error-container"),g=document.getElementById("error-message");function i(o){g.textContent=o,y.classList.remove("hidden")}function d(){const o=s.getItems();l.innerHTML=o.length?"":'<p class="text-center">Your cart is empty.</p>';let a=0;o.forEach(e=>{const n=document.createElement("div");n.className="flex flex-col md:flex-row justify-between items-center border p-4 rounded shadow gap-4";const c=e.image?`<img src="${e.image.src}" alt="${e.name}" class="h-20 object-cover rounded" />`:"";n.innerHTML=`
                    <div class="flex items-center gap-4">
                        ${c}
                        <div>
                            <p class="font-semibold">${e.name}</p>
                            <p class="text-sm text-gray-600">Quantity: ${e.quantity}</p>
                            <p class="text-sm text-gray-800">Price: $${(e.price*e.quantity).toFixed(2)}</p>
                        </div>
                    </div>
                    <button class="text-red-500 hover:text-red-700" data-id="${e.id}">Remove</button>
                `,n.querySelector("button").addEventListener("click",()=>{s.removeItem(e.id),d()}),l.appendChild(n),a+=e.price*e.quantity}),p.textContent=a.toFixed(2)}document.getElementById("checkout-form").addEventListener("submit",async o=>{o.preventDefault();const a=o.target,e=a.name.value,n=a.email.value,c={customer:{name:e,email:n},cart:s.getItems(),totalAmount:s.getItems().reduce((t,r)=>t+r.price*(r.quantity||1),0),currency:"usd",timestamp:new Date().toISOString()};console.log("Submitting payment payload:",c);const u=location.hostname==="localhost"?"http://localhost:8787":"https://cart-checkout-worker.greg-l-turnquist.workers.dev";try{const t=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!t.ok){const m=await t.text();console.error("Checkout failed:",t.status,m),i("There was an error processing your payment. Please try again.");return}const r=await t.json();r&&r.url?window.location.href=r.url:i("There was an error processing your payment. Please try again.")}catch(t){console.error("Checkout error: ",t),i("A network error occurred. Please check your connection and try again.")}});document.addEventListener("DOMContentLoaded",d);window.addEventListener("cartUpdated",d);
